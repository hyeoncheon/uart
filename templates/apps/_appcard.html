<div class="wg card shadow">
	<div class="wg thumb">
		<%= imageFor(app.AppIcon, "wg icon32") %>
	</div>
	<div class="wg title">
		<b><a href="<%= appPath({app_id: app.ID}) %>"><%= app.Name %></a></b>
		<div class="wg meta">
			<div><%= app.Description %></div>
		</div>
	</div>
	<div class="wg content indented">
		<% let rc = (len(member.AppRoles(app, true))+len(member.AppRoles(app, false))) %>
		<% let is_active = true %>
		<%= for (role) in member.AppRoles(app, true) { %><%
partial("roles/roleline.html") %><%
		} %>
		<% let is_active = false %>
		<%= for (role) in member.AppRoles(app, false) { %><%
partial("roles/roleline.html") %><%
		} %>
	</div>
	<div class="wg extra">
		<p class="btn-group pull-right">

		<a class="btn btn-xs btn-default<%= if (!member.IsActive) {
			%> disabled<% } %>" data-toggle="modal" data-target="#reqRole-<%=
			app.ID %>"><%=t("role.request")%></a>

		<a class="btn btn-xs btn-danger<%=
		if (app.Code == "uart") { %> disabled<%
			} %>" href="<%= revokePath({ app_id: app.ID })
			%>" data-confirm="<%=t("are.you.sure")%>"><%=t("revoke")%></a>
		</p>
	</div>
</div>

<!-- Modal for Role -->
<div class="modal fade" id="reqRole-<%= app.ID %>" tabindex="-1" role="dialog">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title"><%=t("role.request")%></h4>
			</div>
			<%= form_for(app, {action: requestPath(), method: "POST"}) { %>
			<div class="modal-body">
				<p>
				<%=t("modal.message.select.perfered.roles.for.this.app")%>
				</p>
				<%= for (role) in app.GetRoles() { %><%=
					if ((role.Code != "admin") && (!member.HasRole(role.ID))) { %>
				<div class="checkbox">
					<label><input type="checkbox" id="app-role" name="role_id" value="<%=
						role.ID %>"><%= role.Name %></label>
				</div><% } %><% } %>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-warning" data-dismiss="modal" aria-label="Close"><%=t("close")%></button>
				<button class="btn btn-success" style="width: 120px" role="submit"><%=t("request")%></button>
			</div>
			<% } %>
		</div><!-- /.modal-content -->
	</div><!-- /.modal-dialog -->
</div><!-- /.modal -->
